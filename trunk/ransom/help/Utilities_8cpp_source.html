<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>RANSOM: Fichero Fuente src/Utilities.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">RANSOM
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generado por Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Buscar');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>P치gina&#160;principal</span></a></li>
      <li><a href="pages.html"><span>P치ginas&#160;relacionadas</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Clases</span></a></li>
      <li class="current"><a href="files.html"><span>Archivos</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Buscar" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>Lista&#160;de&#160;archivos</span></a></li>
      <li><a href="globals.html"><span>Miembros&#160;de&#160;los&#160;ficheros</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('Utilities_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>Todo</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Clases</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Archivos</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Funciones</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>&apos;typedefs&apos;</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumeraciones</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Valores de enumeraciones</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Amigas</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>&apos;defines&apos;</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>P치ginas</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Utilities.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Utilities_8cpp.html">Ir a la documentaci칩n de este archivo.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Utilities_8h.html">Utilities.h</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;OgreVector3.h&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<a class="code" href="classUtilities.html" title="this class will be a set of utility methods This class follow the singleton pattern ...">Utilities</a>* <a class="code" href="classUtilities.html#ac63468e18f1b17260970e4690303dc1d" title="reference to Utitlies object ">Utilities::msSingleton</a> = NULL;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno"><a class="code" href="classUtilities.html#aac351cff9a13eb2d6bd02f38c5b062c0">    6</a></span>&#160;<a class="code" href="classUtilities.html" title="this class will be a set of utility methods This class follow the singleton pattern ...">Utilities</a>&amp; <a class="code" href="classUtilities.html#aac351cff9a13eb2d6bd02f38c5b062c0" title="method to get the Utilities object ">Utilities::getSingleton</a>()</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  {</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    <span class="keywordflow">if</span> ( NULL == <a class="code" href="classUtilities.html#ac63468e18f1b17260970e4690303dc1d" title="reference to Utitlies object ">msSingleton</a> )</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;      <a class="code" href="classUtilities.html#ac63468e18f1b17260970e4690303dc1d" title="reference to Utitlies object ">msSingleton</a> = <span class="keyword">new</span> <a class="code" href="classUtilities.html#ab1676c9ce35cf347a73d16f1094e1271" title="default constructor ">Utilities</a>;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="keywordflow">return</span> (*<a class="code" href="classUtilities.html#ac63468e18f1b17260970e4690303dc1d" title="reference to Utitlies object ">msSingleton</a>);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  }</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="code" href="classUtilities.html#a13eb614cf626a46b6584bec2ec42244c">   14</a></span>&#160;<a class="code" href="classUtilities.html" title="this class will be a set of utility methods This class follow the singleton pattern ...">Utilities</a>* <a class="code" href="classUtilities.html#a13eb614cf626a46b6584bec2ec42244c" title="method to get the Utilities reference ">Utilities::getSingletonPtr</a>()</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  {</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordflow">if</span> ( NULL == <a class="code" href="classUtilities.html#ac63468e18f1b17260970e4690303dc1d" title="reference to Utitlies object ">msSingleton</a> )</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;      <a class="code" href="classUtilities.html#ac63468e18f1b17260970e4690303dc1d" title="reference to Utitlies object ">msSingleton</a> = <span class="keyword">new</span> <a class="code" href="classUtilities.html#ab1676c9ce35cf347a73d16f1094e1271" title="default constructor ">Utilities</a>();</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="classUtilities.html#ac63468e18f1b17260970e4690303dc1d" title="reference to Utitlies object ">msSingleton</a>);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  }</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="code" href="classUtilities.html#a153165e07ae59015a8abdecb84b8d521">   22</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUtilities.html#a153165e07ae59015a8abdecb84b8d521" title="method to put an overlay in the scene This method put an overlay created in ransom.overlay file, also the name should be defined in this file with the set of specifications ">Utilities::put_overlay</a> ( Ogre::OverlayManager *overMgr, <span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keywordtype">bool</span> visible )</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    Ogre::Overlay *over = NULL;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    over = overMgr-&gt;getByName ( name );</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">if</span> ( over )</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="keywordflow">if</span> ( visible )</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;            over-&gt;show();</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;            over-&gt;hide();</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        cerr &lt;&lt; <span class="stringliteral">&quot;Overlay name was not found!!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      }</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;}</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="code" href="classUtilities.html#a87e9c4676e4ef46b04232013dc8c1633">   41</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUtilities.html#a87e9c4676e4ef46b04232013dc8c1633" title="method to put an overlay in an object Rectangle2D This method put an overlay created in ransom...">Utilities::put_overlay_on_rectangle</a> ( Ogre::Rectangle2D* rect, <span class="keyword">const</span> <span class="keywordtype">char</span>* name, Ogre::Real left, Ogre::Real top, Ogre::Real right, Ogre::Real bottom, <span class="keywordtype">bool</span> visible )</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// Create background rectangle covering the whole screen</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    rect = <span class="keyword">new</span> Ogre::Rectangle2D ( <span class="keyword">true</span> );</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    rect-&gt;setCorners ( left, top, right, bottom );</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    rect-&gt;setMaterial ( name );</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">// Render the background before everything else</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    rect-&gt;setRenderQueueGroup ( Ogre::RENDER_QUEUE_BACKGROUND );</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    rect-&gt;setVisible ( visible );</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="code" href="classUtilities.html#ad10afebb74461d39b4aa788f036f0e8d">   54</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUtilities.html#ad10afebb74461d39b4aa788f036f0e8d" title="method to create a rotate background This method uses the method put_overlay_on_rectangle() to do par...">Utilities::put_background_with_rotation</a> ( Ogre::SceneManager* sceneMgr, <span class="keyword">const</span> <span class="keywordtype">char</span>* background )</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// Create background material</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    Ogre::MaterialPtr material = Ogre::MaterialManager::getSingleton().create ( <span class="stringliteral">&quot;Background&quot;</span>, <span class="stringliteral">&quot;General&quot;</span> );</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    material-&gt;getTechnique(0)-&gt;getPass(0)-&gt;createTextureUnitState ( background );</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    material-&gt;getTechnique(0)-&gt;getPass(0)-&gt;setDepthCheckEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    material-&gt;getTechnique(0)-&gt;getPass(0)-&gt;setDepthWriteEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    material-&gt;getTechnique(0)-&gt;getPass(0)-&gt;setLightingEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    Ogre::Rectangle2D* rect = NULL;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="classUtilities.html#a87e9c4676e4ef46b04232013dc8c1633" title="method to put an overlay in an object Rectangle2D This method put an overlay created in ransom...">put_overlay_on_rectangle</a> ( rect, <span class="stringliteral">&quot;Background&quot;</span>, -2.0, 1.0, 2.0, -1.0, <span class="keyword">true</span> );</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// Use infinite AAB to always stay visible</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    Ogre::AxisAlignedBox aabInf;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    aabInf.setInfinite();</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    rect-&gt;setBoundingBox(aabInf);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// Attach background to the scene</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    Ogre::SceneNode* node = sceneMgr-&gt;getRootSceneNode()-&gt;createChildSceneNode ( <span class="stringliteral">&quot;Background&quot;</span> );</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    node-&gt;attachObject ( rect );</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">// Example of background scrolling</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    material-&gt;getTechnique(0)-&gt;getPass(0)-&gt;getTextureUnitState(0)-&gt;setScrollAnimation ( -0.015, 0.0 );</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="code" href="classUtilities.html#a3646c62aff5e331550cdf464ad5179bf">   79</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUtilities.html#a3646c62aff5e331550cdf464ad5179bf" title="this method add an shot at character ">Utilities::put_shot_in_scene</a> ( Ogre::SceneManager* sceneMgr,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                                                                                  <span class="keywordtype">string</span> name,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                                                                                  Ogre::SceneNode* nodeShot,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                                                                                  Ogre::ManualObject** shot)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    *shot =  sceneMgr-&gt;createManualObject(name + <span class="stringliteral">&quot;LineSHOT&quot;</span>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        (*shot)-&gt;begin(<span class="stringliteral">&quot;MaterialBlanco&quot;</span>, Ogre::RenderOperation::OT_LINE_LIST); </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        (*shot)-&gt;position(Ogre::Vector3::ZERO);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        Ogre::Vector3 posFin(nodeShot-&gt;getOrientation().zAxis() * 1);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        (*shot)-&gt;position(posFin);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        (*shot)-&gt;end();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    (*shot)-&gt;setCastShadows(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    nodeShot-&gt;attachObject ( (*shot) );</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="code" href="classUtilities.html#ad9d9b0c6e6793366ea65ad5082b66521">   94</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUtilities.html#ad9d9b0c6e6793366ea65ad5082b66521" title="this method add an plane in the scene ">Utilities::put_plane_in_scene</a> ( Ogre::SceneManager* sceneMgr,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                                  OgreBulletDynamics::DynamicsWorld* world,</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                                                                                                  Ogre::StaticGeometry *staticGeometry,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                                  <span class="keywordtype">string</span> namePlane,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                                                                                  <span class="keywordtype">string</span> nameMaterial,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                                                                                  <span class="keywordtype">float</span> width,</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                                                                                  <span class="keywordtype">float</span> height,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                                                                                  Ogre::Vector3 upVector,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                                                                                  Ogre::Vector3 normal,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                                  <span class="keyword">const</span> Ogre::Vector3&amp; initial_pos ) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="comment">// Define a floor plane mesh</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        Ogre::Entity *entPlane;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        Ogre::Plane plane;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        plane.normal = normal; plane.d = 0;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        Ogre::MeshManager::getSingleton().createPlane ( namePlane + <span class="stringliteral">&quot;PlaneMesh&quot;</span>,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                                                                Ogre::ResourceGroupManager::DEFAULT_RESOURCE_GROUP_NAME,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                                                                plane, width, height,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                                                1, 1, <span class="keyword">true</span>, 1, 1, 1,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                                                upVector );</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="comment">// Create an entity plane</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        entPlane = sceneMgr-&gt;createEntity(namePlane  + <span class="stringliteral">&quot;PlaneEntity&quot;</span>, namePlane  + <span class="stringliteral">&quot;PlaneMesh&quot;</span>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        entPlane-&gt;setMaterialName(nameMaterial);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        entPlane-&gt;setCastShadows(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        staticGeometry-&gt;addEntity(entPlane, initial_pos);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="comment">// add collision detection to it</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        OgreBulletCollisions::CollisionShape *shapePlane = <span class="keyword">new</span> OgreBulletCollisions::StaticPlaneCollisionShape ( normal, 0 ); <span class="comment">// (normal vector, distance)</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="comment">// a body is needed for the shape</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        OgreBulletDynamics::RigidBody *defaultPlaneBody = <span class="keyword">new</span> OgreBulletDynamics::RigidBody ( namePlane  + <span class="stringliteral">&quot;PlaneBody&quot;</span>, world );</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        defaultPlaneBody-&gt;setStaticShape ( shapePlane, 0.1, 0.8, initial_pos);<span class="comment">// (shape, restitution, friction, position)</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="code" href="classUtilities.html#aa07a055a9ad92d6d160b70db8051b418">  127</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classUtilities.html#aa07a055a9ad92d6d160b70db8051b418" title="this method add an part map in the scene ">Utilities::put_part_map_in_scene</a> ( Ogre::SceneManager* sceneMgr,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                                  OgreBulletDynamics::DynamicsWorld* world,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                                                                                  Ogre::StaticGeometry *staticGeometry,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                                  <span class="keywordtype">string</span> namePart,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                                                                                  <span class="keywordtype">string</span> namePartMesh,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                                  <span class="keyword">const</span> Ogre::Vector3&amp; initial_pos) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        Ogre::Entity *entity = sceneMgr-&gt;createEntity(namePart, namePartMesh + <span class="stringliteral">&quot;.mesh&quot;</span>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        entity-&gt;setCastShadows(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        staticGeometry-&gt;addEntity(entity, initial_pos);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    OgreBulletCollisions::StaticMeshToShapeConverter *trimeshConverter = <span class="keyword">new</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    OgreBulletCollisions::StaticMeshToShapeConverter(entity);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    OgreBulletCollisions::TriangleMeshCollisionShape *trackTrimesh =</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    trimeshConverter-&gt;createTrimesh();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    OgreBulletDynamics::RigidBody *rigidTrack = <span class="keyword">new</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    OgreBulletDynamics::RigidBody(namePart, world);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        rigidTrack-&gt;setStaticShape(trackTrimesh, 0.8, 0.95, initial_pos);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keyword">delete</span> trimeshConverter;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="code" href="classUtilities.html#ad272a05542524f6480df6411838a968d">  146</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUtilities.html#ad272a05542524f6480df6411838a968d" title="this method add an element (mesh name) in the scene (Ogre) and in the world (OgreBullet) This method ...">Utilities::put_character_in_scene</a> ( Ogre::SceneManager* sceneMgr,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                                  OgreBulletDynamics::DynamicsWorld* world,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                                  <span class="keywordtype">string</span> name_mesh,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                                  <span class="keywordtype">string</span> name_element,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                                                  <span class="keyword">const</span> Ogre::Vector3&amp; initial_pos,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                                  Ogre::Entity** entity,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                                                  Ogre::SceneNode** node,</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                                                  OgreBulletDynamics::RigidBody** rigidTrack,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                                                  <span class="keywordtype">bool</span> visible,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                                  <span class="keywordtype">string</span> initAnimation )</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    *entity = sceneMgr-&gt;createEntity ( name_element, name_mesh + <span class="keywordtype">string</span> ( <span class="stringliteral">&quot;.mesh&quot;</span> ) );</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    (*entity)-&gt;setCastShadows(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    (*entity)-&gt;setVisible(visible);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    *node = sceneMgr-&gt;createSceneNode ( name_element );</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    (*node)-&gt;attachObject ( *entity );</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">if</span> (initAnimation != <span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        Ogre::AnimationState *animation = (*entity)-&gt;getAnimationState(initAnimation);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        animation-&gt;setEnabled(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        animation-&gt;setLoop(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    sceneMgr-&gt;getRootSceneNode()-&gt;addChild ( *node );</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    OgreBulletCollisions::CollisionShape* sceneBoxShape = NULL;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span> (initAnimation == <span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        OgreBulletCollisions::StaticMeshToShapeConverter* trimeshConverter = <span class="keyword">new</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          OgreBulletCollisions::StaticMeshToShapeConverter ( *entity );</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        sceneBoxShape = (OgreBulletCollisions::CollisionShape*) trimeshConverter-&gt;createConvex();</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keyword">delete</span> trimeshConverter;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        OgreBulletCollisions::AnimatedMeshToShapeConverter* trimeshConverter = <span class="keyword">new</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          OgreBulletCollisions::AnimatedMeshToShapeConverter ( *entity );</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        sceneBoxShape = (OgreBulletCollisions::CollisionShape*) trimeshConverter-&gt;createConvex();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keyword">delete</span> trimeshConverter;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    *rigidTrack = <span class="keyword">new</span> OgreBulletDynamics::RigidBody ( name_element, world );</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    (*rigidTrack)-&gt;setShape ( *node, sceneBoxShape, 0.6, 0.6, 80.0f,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                            initial_pos, (*node)-&gt;_getDerivedOrientation() );</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    (*rigidTrack)-&gt;getBulletRigidBody()-&gt;setAngularFactor(0.0f);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  }</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="Utilities_8cpp.html">Utilities.cpp</a></li>
    <li class="footer">Generado el Lunes, 8 de Julio de 2013 09:43:16 para RANSOM por
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
